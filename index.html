import { useEffect } from "react";

export default function Game() {
  useEffect(() => {
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    let currentScene = 0;
    const scenes = [
      "Welcome to the Haunted Woods",
      "You found the school bus with your missing friends",
      "You enter the haunted school... something is watching",
      "The bathroom door creaks open... screeching sounds fill the hall",
      "The cloaked man absorbs the monster... everything transforms!"
    ];
    
    document.getElementById("nextScene").addEventListener("click", () => {
      if (currentScene < scenes.length - 1) {
        currentScene++;
        document.getElementById("scene-text").innerText = scenes[currentScene];
      }
    });
    
    function drawScene() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawFireflies();
    }
    
    function drawFireflies() {
      ctx.fillStyle = "yellow";
      for (let i = 0; i < 10; i++) {
        let x = Math.random() * canvas.width;
        let y = Math.random() * canvas.height;
        ctx.beginPath();
        ctx.arc(x, y, 2, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    
    const interval = setInterval(drawScene, 100);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className="game-container w-screen h-screen bg-black flex items-center justify-center p-4 sm:p-8 md:p-12 relative overflow-hidden">
      <canvas id="gameCanvas" className="absolute top-0 left-0 w-full h-full"></canvas>
      <div className="absolute top-0 left-0 w-full h-full bg-opacity-30 bg-gray-900 animate-flicker"></div>
      <div id="scene-text" className="text-red-500 text-lg sm:text-xl md:text-2xl font-bold text-center z-10">Welcome to the Haunted Woods</div>
      <audio id="backgroundMusic" autoPlay loop>
        <source src="/sounds/horror-background.mp3" type="audio/mpeg" />
      </audio>
      <audio id="schoolHallMusic">
        <source src="/sounds/eery-school-hall.mp3" type="audio/mpeg" />
      </audio>
      <audio id="screechingSound">
        <source src="/sounds/screeching.mp3" type="audio/mpeg" />
      </audio>
      <button id="nextScene" className="absolute bottom-10 right-10 bg-yellow-500 text-black p-2 rounded">Next</button>
      <div id="joystick-container" className="absolute bottom-10 left-10 w-24 h-24 bg-gray-700 rounded-full opacity-70 flex items-center justify-center">
        <div id="joystick" className="w-12 h-12 bg-gray-500 rounded-full"></div>
      </div>
    </div>
  );
}
